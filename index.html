<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>yirufeng&#39;s Blog | 未来的小幸运 || 致正在努力的我们 ---- 逸如风</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content>
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.2">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	false,
            lv: JSON.parse('{"enable":true,"app_id":"K2RVtHi7RnmoN6dovlDKafn8-gzGzoHsz","app_key":"Qxmil0oqPFdDUyyIp2i1Xikt","icon":true}'),
            v: JSON.parse('{"enable":false,"appid":"ACuOJIasBeRLiDe2iUApHj67-gzGzoHsz","appkey":"qbgg4tClrQQmvq8uwlpwA5mA","notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/1.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">逸如风(yirufeng)</h5>
          <a href="mailto:yirufeng@foxmail.com" title="yirufeng@foxmail.com" class="mail">
            
              <span>y</span>
            
              <span>i</span>
            
              <span>r</span>
            
              <span>u</span>
            
              <span>f</span>
            
              <span>e</span>
            
              <span>n</span>
            
              <span>g</span>
            
              <span>@</span>
            
              <span>f</span>
            
              <span>o</span>
            
              <span>x</span>
            
              <span>m</span>
            
              <span>a</span>
            
              <span>i</span>
            
              <span>l</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/sivanWu0222" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
              <li>
                <a href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;amp;email=xfTz8-Py8-f08vWFtLTrpqqo" target="_blank">
                  <i class="icon icon-lg icon-envelope"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class=" active">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Category
              </a>
            </li>
        
            <li class="">
              <a href="/research"  >
                <i class="icon icon-lg icon-mortar-board"></i>
                Research
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tag
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archive
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="">
              <a href="/open-source"  >
                <i class="icon icon-lg icon-github"></i>
                Project
              </a>
            </li>
        
            <li class="">
              <a href="/demo"  >
                <i class="icon icon-lg icon-audio-description"></i>
                Demo
              </a>
            </li>
        
            <li class="">
              <a href="/wechat-number"  >
                <i class="icon icon-lg icon-wechat"></i>
                公众号
              </a>
            </li>
        
            <li class="">
              <a href="http://www.sivan.tech/LeetCodeAlgo/" target="_blank" >
                <i class="icon icon-lg icon-braille"></i>
                Leetcode
              </a>
            </li>
        
            <li class="">
              <a href="http://resume.sivan.tech/" target="_blank" >
                <i class="icon icon-lg icon-file-pdf-o"></i>
                Resume
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        
    <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>yirufeng&#39;s Blog</span>
            
            <span> - </span>
            <span class="header-description">未来的小幸运 || 致正在努力的我们 ---- 逸如风</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header index-header">
    <img src="/img/s3.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">yirufeng&#39;s Blog</h1>
        <h5 class="subtitle">
            
                <a href="javascript:;" style="color: #fff; margin-right: 4px;">
                  <i class="icon icon-map-marker icon-1x">Wuhan, China</i>
              </a><a href="https://github.com/sivanWu0222" style="color: #fff; margin-right: 4px;">
                  <i class="icon icon-github icon-1x">sivanWu0222</i>
              </a>
            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>

    <div class="container body-wrap">
        <ul class="post-list">
        
            <li class="post-list-item fade">
                <article id="post-csv模块写入csv文件-os创建目录-np-prod计算元素成绩"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/11/30/csv模块写入csv文件-os创建目录-np-prod计算元素成绩/">csv模块写入csv文件 os创建目录 np.prod计算元素乘积</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-11-30 16:39:53" datetime="2019-11-30T16:39:53.000Z"  itemprop="datePublished">2019-11-30</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/">Python</a></li></ul>



        
	<span id="/2019/11/30/csv模块写入csv文件-os创建目录-np-prod计算元素成绩/" class="leancloud_visitors" data-flag-title="csv模块写入csv文件 os创建目录 np.prod计算元素乘积" title="csv模块写入csv文件 os创建目录 np.prod计算元素乘积">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <h2 id="csv-库的使用"><a href="#csv-库的使用" class="headerlink" title="csv 库的使用"></a>csv 库的使用</h2><h3 id="写csv文件"><a href="#写csv文件" class="headerlink" title="写csv文件"></a>写csv文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'result.csv'</span>, <span class="string">"a+"</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">        writer = csv.writer(f, delimiter=<span class="string">':'</span>)  <span class="comment"># delimiter用于csv文件中分隔符的显示,默认是,</span></span><br><span class="line">        writer.writerow([<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<p>np.prod() 默认计算所有元素乘积，无论传入进来的是一个向量还是一个tensor, 可以指定axis=1用来获取每一行的乘积</p>
<h3 id="写入和读取csv文件"><a href="#写入和读取csv文件" class="headerlink" title="写入和读取csv文件"></a>写入和读取csv文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(os.path.join(self.root, filename), mode=<span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">                writer = csv.writer(f)</span><br><span class="line">                <span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="index-item-img">
<h2 id="glob库的使用"><a href="#glob库的使用" class="headerlink" title="glob库的使用"></a>glob库的使用</h2><blockquote>
<p>glob根据指定文件名字的规则进行文件名的搜寻，并返回一个列表</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># glob模块根据规则匹配特定的文件名字并返回一个列表,所以采用+将列表进行拼接而不是作为元素加入列表中</span></span><br><span class="line">            images += (glob.glob(os.path.join(self.root, name, <span class="string">'*.png'</span>)))</span><br><span class="line">            images += (glob.glob(os.path.join(self.root, name, <span class="string">'*.jpeg'</span>)))</span><br><span class="line">            images += (glob.glob(os.path.join(self.root, name, <span class="string">'*.jpg'</span>)))</span><br></pre></td></tr></table></figure>
<h2 id="使用os内置库创建目录"><a href="#使用os内置库创建目录" class="headerlink" title="使用os内置库创建目录"></a>使用os内置库创建目录</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建目录存放生成的图片</span></span><br><span class="line"><span class="comment">## os.makedirs 会递归创建目录</span></span><br><span class="line"><span class="comment">## os.mkdir 只会创建子目录</span></span><br><span class="line">os.makedirs(<span class="string">'images'</span>, exist_ok=<span class="literal">True</span>)  <span class="comment"># 如果exist_ok是False,目标目录存在时返回OSError</span></span><br><span class="line">os.mkdir(<span class="string">'path'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="从一个对象知道对应的类的名字"><a href="#从一个对象知道对应的类的名字" class="headerlink" title="从一个对象知道对应的类的名字"></a>从一个对象知道对应的类的名字</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">class_name</span><span class="params">(cl)</span>:</span></span><br><span class="line">    <span class="comment"># return cl.__class__  # &lt;class '__main__.config'&gt;</span></span><br><span class="line">    <span class="keyword">return</span> cl.__class__.__name__  <span class="comment"># 返回类名字 config</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">config</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    con = config()</span><br><span class="line">    print(class_name(con))</span><br></pre></td></tr></table></figure>
<h2 id="使用np-prod-计算元素成绩"><a href="#使用np-prod-计算元素成绩" class="headerlink" title="使用np.prod()计算元素成绩"></a>使用np.prod()计算元素成绩</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">result = np.prod(a)  <span class="comment"># 当指定axis=1,求行的乘积</span></span><br></pre></td></tr></table></figure>
    
    <a href="/2019/11/30/csv模块写入csv文件-os创建目录-np-prod计算元素成绩/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csv/">csv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/numpy/">numpy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/os/">os</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-Python-线程池爬虫的简单实用"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/11/30/Python-线程池爬虫的简单实用/">Python 线程池爬虫的简单使用</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-11-30 16:37:18" datetime="2019-11-30T16:37:18.000Z"  itemprop="datePublished">2019-11-30</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/">Python</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/多线程/">多线程</a></li></ul></li></ul>



        
	<span id="/2019/11/30/Python-线程池爬虫的简单实用/" class="leancloud_visitors" data-flag-title="Python 线程池爬虫的简单使用" title="Python 线程池爬虫的简单使用">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
  <span><i class="icon icon-github"></i></span>

        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <h1 id="python使用线程池进行编程"><a href="#python使用线程池进行编程" class="headerlink" title="python使用线程池进行编程"></a>python使用线程池进行编程</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import concurrent</span><br><span class="line">from concurrent import futures  # 做多线程和多进程编程</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor</span><br><span class="line">from concurrent.futures import as_completed</span><br></pre></td></tr></table></figure>
<h1 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">## 为什么需要线程池</span><br><span class="line">## 主线程中可以获取某一个线程的状态或者某一个任务的状态以及返回值</span><br><span class="line">## 当一个线程完成的时候我们主线程也可以立即知道</span><br><span class="line">## futures可以让多线程和多进程编码一致</span><br><span class="line"></span><br><span class="line">import time</span><br><span class="line">def get_html(times):</span><br><span class="line">    time.sleep(times)  # 休眠</span><br><span class="line"></span><br><span class="line">    print(&apos;get page &#123;&#125; success&apos;.format(times))</span><br><span class="line">    return times</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    executor = ThreadPoolExecutor(max_workers=2)</span><br><span class="line"></span><br><span class="line">    # 提交任务</span><br><span class="line">    ## 通过submit函数提交执行的函数到线程池中</span><br><span class="line">    ## submit是非阻塞的，将会立即返回</span><br><span class="line">    task1 = executor.submit(get_html, (3))  # 第一个参数是函数名称，第二个参数是函数的参数</span><br><span class="line">    task2 = executor.submit(get_html, (10))  # 会有一个返回结果</span><br><span class="line"></span><br><span class="line">    # done 方法用于判定某个任务是否完成</span><br><span class="line">    print(task1.done())  # 判断这个函数是否执行成功</span><br><span class="line">    time.sleep(4)</span><br><span class="line">    print(task2.done())</span><br><span class="line"></span><br><span class="line">    # result 方法得到task执行的返回结果</span><br><span class="line">    print(task2.result())</span><br><span class="line">    print(task1.result())</span><br><span class="line"></span><br><span class="line">    # 将某一个任务cancel掉， 在submit返回的对象上进行操作，</span><br><span class="line">    task2.cancel()  # 只有在还没有执行的时候cancel掉</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 获取已经成功的task的返回as_completed 是一个生成器</span><br><span class="line">executor = ThreadPoolExecutor(max_workers=4)</span><br><span class="line">urls = [10, 10, 10]</span><br><span class="line">all_tasks = [executor.submit(get_html, url) for url in urls]</span><br><span class="line"></span><br><span class="line"># 异步运行</span><br><span class="line"># for future in as_completed(all_tasks):  # 返回已经完成的future</span><br><span class="line">    # data = future.result()  # 得到执行的结果</span><br><span class="line">    # print(data)</span><br><span class="line"></span><br><span class="line"># 通过executor获取已经完成的task， 会按照urls中的元素的顺序执行，但也是并发只是会等待</span><br><span class="line"># for data in executor.map(get_html, urls):  # 直接返回执行的结果</span><br><span class="line">#     print(data)</span><br></pre></td></tr></table></figure>
    
    <a href="/2019/11/30/Python-线程池爬虫的简单实用/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Concurrent/">Concurrent</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-python-tqdm模块使用教程"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/11/15/python-tqdm模块使用教程/">python tqdm模块使用教程</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-11-15 20:48:13" datetime="2019-11-15T20:48:13.000Z"  itemprop="datePublished">2019-11-15</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/">Python</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/tqdm/">tqdm</a></li></ul></li></ul>



        
	<span id="/2019/11/15/python-tqdm模块使用教程/" class="leancloud_visitors" data-flag-title="python tqdm模块使用教程" title="python tqdm模块使用教程">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <h2 id="tqdm-使用教程"><a href="#tqdm-使用教程" class="headerlink" title="tqdm 使用教程"></a>tqdm 使用教程</h2><blockquote>
<p>tqdm 是一个Python进度条模块，用于显示读取进度或者处理进度</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="comment"># 第一种方法</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm.tqdm(range(<span class="number">2</span>)):</span><br><span class="line">    print(i)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 第二种方法</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm.trange(<span class="number">2</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三种方法</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm.tnrange(<span class="number">2</span>, desc=<span class="string">'ours'</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 第四种方法</span></span><br><span class="line">pbar = tqdm.trange(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pbar:</span><br><span class="line">    print(i)</span><br><span class="line">    pbar.set_description(<span class="string">'kaishi'</span>)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行结果如下：</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">/Users/yirufeng/anaconda3/bin/python3.7 /Users/yirufeng/git_repository/DLNN/tqdm使用教程.py</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string"> 50%|█████     | 1/2 [00:01&lt;00:01,  1.00s/it]1</span></span><br><span class="line"><span class="string">100%|██████████| 2/2 [00:02&lt;00:00,  1.00s/it]</span></span><br><span class="line"><span class="string">  0%|          | 0/2 [00:00&lt;?, ?it/s]0</span></span><br><span class="line"><span class="string"> 50%|█████     | 1/2 [00:01&lt;00:01,  1.00s/it]1</span></span><br><span class="line"><span class="string">100%|██████████| 2/2 [00:02&lt;00:00,  1.00s/it]</span></span><br><span class="line"><span class="string">HBox(children=(IntProgress(value=0, description='ours', max=2, style=ProgressStyle(description_width='initial')), HTML(value='')))</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">kaishi:   0%|          | 0/10 [00:00&lt;?, ?it/s]1</span></span><br><span class="line"><span class="string">kaishi:  10%|█         | 1/10 [00:01&lt;00:09,  1.01s/it]2</span></span><br><span class="line"><span class="string">kaishi:  20%|██        | 2/10 [00:02&lt;00:08,  1.00s/it]3</span></span><br><span class="line"><span class="string">kaishi:  40%|████      | 4/10 [00:04&lt;00:06,  1.00s/it]4</span></span><br><span class="line"><span class="string">5</span></span><br><span class="line"><span class="string">kaishi:  50%|█████     | 5/10 [00:05&lt;00:05,  1.00s/it]6</span></span><br><span class="line"><span class="string">kaishi:  70%|███████   | 7/10 [00:07&lt;00:03,  1.00s/it]7</span></span><br><span class="line"><span class="string">8</span></span><br><span class="line"><span class="string">kaishi:  80%|████████  | 8/10 [00:08&lt;00:02,  1.00s/it]9</span></span><br><span class="line"><span class="string">kaishi: 100%|██████████| 10/10 [00:10&lt;00:00,  1.00s/it]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Process finished with exit code 0</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
    
    <a href="/2019/11/15/python-tqdm模块使用教程/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tqdm/">tqdm</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-python中fire库的基本使用"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/11/14/python中fire库的基本使用/">python中fire库的基本使用</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-11-14 18:39:11" datetime="2019-11-14T18:39:11.000Z"  itemprop="datePublished">2019-11-14</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/">Python</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/fire/">fire</a></li></ul></li></ul>



        
	<span id="/2019/11/14/python中fire库的基本使用/" class="leancloud_visitors" data-flag-title="python中fire库的基本使用" title="python中fire库的基本使用">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <p><a href="https://www.cnblogs.com/my_captain/p/9574560.html" target="_blank" rel="noopener">参考教程</a></p>
<h2 id="一个py文件只有一个函数"><a href="#一个py文件只有一个函数" class="headerlink" title="一个py文件只有一个函数"></a>一个py文件只有一个函数</h2><p>只有一个函数时,采用如下命令进行调用：</p>
<blockquote>
<p>python test_fire.py 5 2</p>
</blockquote>
<p><img src="/2019/11/14/python中fire库的基本使用/pycharm_fire.jpg" alt="Pycharm中直接运行的结果"></p  class="index-item-img">
<figure class="image-box">
                <img src="/2019/11/14/python中fire库的基本使用/terminal_fire.jpg" alt="命令行参数运行的结果" title class="index-item-img">
                <p>命令行参数运行的结果</p>
            </figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fire</span><br><span class="line">print(fire.__version__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    fire.Fire(add)</span><br></pre></td></tr></table></figure>
<h2 id="一个py文件有多个函数"><a href="#一个py文件有多个函数" class="headerlink" title="一个py文件有多个函数"></a>一个py文件有多个函数</h2><p>有多个函数时,采用如下命令进行调用：</p>
<blockquote>
<p>python test_fire.py 函数名 参数</p>
</blockquote>
<figure class="image-box">
                <img src="/2019/11/14/python中fire库的基本使用/pycharm_fire2.jpg" alt="Pycharm中直接运行的结果" title class="index-item-img">
                <p>Pycharm中直接运行的结果</p>
            </figure>
<figure class="image-box">
                <img src="/2019/11/14/python中fire库的基本使用/terminal_fire2.jpg" alt="命令行参数运行的结果" title class="index-item-img">
                <p>命令行参数运行的结果</p>
            </figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fire</span><br><span class="line">print(fire.__version__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Calculator</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, a, b)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sub</span><span class="params">(self, a, b)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> a - b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    fire.Fire(Calculator)</span><br></pre></td></tr></table></figure>
    
    <a href="/2019/11/14/python中fire库的基本使用/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fire/">fire</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-Paper-TL-A-survery-on-transfer-learning"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/11/11/Paper-TL-A-survery-on-transfer-learning/">[Paper_TL]A survery on transfer learning</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-11-11 12:33:15" datetime="2019-11-11T12:33:15.000Z"  itemprop="datePublished">2019-11-11</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Paper/">Paper</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Paper/Transfer-Learning/">Transfer Learning</a></li></ul></li></ul>



        
	<span id="/2019/11/11/Paper-TL-A-survery-on-transfer-learning/" class="leancloud_visitors" data-flag-title="[Paper_TL]A survery on transfer learning" title="[Paper_TL]A survery on transfer learning">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        three main research issues of transfer learning
what to transfer

“What to transfer” asks which part of knowledge can be transferred across domains or tasks. Some knowledge is specific for individu...
    
    <a href="/2019/11/11/Paper-TL-A-survery-on-transfer-learning/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Paper/">Paper</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/">notes</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-数据竞赛-数据预处理以及特征选择"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/11/04/数据竞赛-数据预处理以及特征选择/">数据竞赛:数据预处理以及特征选择</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-11-04 16:48:25" datetime="2019-11-04T16:48:25.000Z"  itemprop="datePublished">2019-11-04</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/数据竞赛/">数据竞赛</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/数据竞赛/数据处理以及特征工程/">数据处理以及特征工程</a></li></ul></li></ul>



        
	<span id="/2019/11/04/数据竞赛-数据预处理以及特征选择/" class="leancloud_visitors" data-flag-title="数据竞赛:数据预处理以及特征选择" title="数据竞赛:数据预处理以及特征选择">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame([[<span class="number">1</span>, np.nan, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, np.nan], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<h1 id="对缺失数据的处理"><a href="#对缺失数据的处理" class="headerlink" title="对缺失数据的处理"></a>对缺失数据的处理</h1><h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data1 = data.dropna()  <span class="comment"># 默认是按照行删除</span></span><br><span class="line">data2 = data.dropna(axis=<span class="number">0</span>)  <span class="comment"># 按照行删除</span></span><br><span class="line">data3 = data.dropna(axis=<span class="number">1</span>)  <span class="comment"># 按照列删除</span></span><br><span class="line">print(data1)</span><br><span class="line">print(data2)</span><br><span class="line">print(data3)</span><br></pre></td></tr></table></figure>
<p><strong>note:前面几个虽然删除了空数据，但是并没有对data中的数据进行删除，需要我们指定inplace=True才会对在data上删除</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.dropna(axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure></p>
<h2 id="填充"><a href="#填充" class="headerlink" title="填充"></a>填充</h2><p>指定值进行填充<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame([[<span class="number">1</span>, np.nan, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, np.nan], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line">data1 = data.fillna(<span class="number">-1</span>)  <span class="comment"># 用指定值进行填充</span></span><br><span class="line">print(data1)</span><br></pre></td></tr></table></figure></p>
<p>均值填充<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(data.mean())  <span class="comment"># 默认是按照列求均值，计算有值的数值的和，然后统计有值的数值的个数，用和求个数得到每列均值</span></span><br><span class="line">data2 = data.fillna(data.mean())</span><br><span class="line">print(data2)</span><br></pre></td></tr></table></figure></p>
<p>采用前面的值填充<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data3 = data.fillna(method=<span class="string">'pad'</span>)  <span class="comment"># 使用数据的前一个值(所在列的前一个值，即上一行该列的元素值)对后一个值进行填充</span></span><br><span class="line">print(data3)</span><br></pre></td></tr></table></figure></p>
<p>采用后面的值进行填充<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data4 = data.fillna(method=<span class="string">'bfill'</span>)  <span class="comment"># 使用数据的后一个值对前一个值进行填充</span></span><br><span class="line">print(data4)</span><br><span class="line"></span><br><span class="line">data5 = data.interpolate()  <span class="comment"># 采用差值法进行填充，默认是线性差值, 算是预测填充的一种</span></span><br><span class="line">print(data5)</span><br></pre></td></tr></table></figure></p>
<h1 id="处理缺失值与重复值"><a href="#处理缺失值与重复值" class="headerlink" title="处理缺失值与重复值"></a>处理缺失值与重复值</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 处理缺失值与重复值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Data_preprocessing</span><span class="params">(x, feat_Remv)</span>:</span></span><br><span class="line">    <span class="comment"># 删除重复值</span></span><br><span class="line">    x = x.drop_duplicates()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 删除指定字段</span></span><br><span class="line">    x = x.drop(feat_Remv, axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 补充缺失值</span></span><br><span class="line">    x = x.fillna(<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">feat_Remv = [<span class="string">'instance_id'</span>, <span class="string">'creative_is_js'</span>, <span class="string">'creative_is_voicead'</span>, <span class="string">'app_paid'</span>]</span><br><span class="line">train_data = Data_preprocessing(train_data, feat_Remv)</span><br><span class="line">test_data = Data_preprocessing(test_data, feat_Remv)</span><br></pre></td></tr></table></figure>
<h1 id="特征缩放"><a href="#特征缩放" class="headerlink" title="特征缩放"></a>特征缩放</h1><ol>
<li>Min-Max normalization: (x - min) / (max - min)</li>
<li>Mean normalization: (x - avg) / (max - min)</li>
<li>Standardization: (x - avg) / (std)</li>
</ol>
<h2 id="如何做特征缩放"><a href="#如何做特征缩放" class="headerlink" title="如何做特征缩放"></a>如何做特征缩放</h2><h3 id="Min-Max-normalization"><a href="#Min-Max-normalization" class="headerlink" title="Min-Max normalization"></a>Min-Max normalization</h3><p><strong>Note:归一化不是让特征值范围是0-1之间，指所在一个特定范围内</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line">data = [[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]]</span><br><span class="line">print(MinMaxScaler(feature_range=(<span class="number">0</span>, <span class="number">1</span>)).fit_transform(data))  <span class="comment"># feature_map选择归一化后的取值范围</span></span><br><span class="line"></span><br><span class="line">data = [[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]]</span><br><span class="line">print(MinMaxScaler(feature_range=(<span class="number">-2</span>, <span class="number">2</span>)).fit_transform(data))  <span class="comment"># feature_map选择归一化后的取值范围为-2~2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### Mean normalization</span></span><br><span class="line">data = [[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]]</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(np.max(df))  <span class="comment"># 求得每列的最大值，并返回一个ndarray</span></span><br><span class="line">print(np.mean(df))  <span class="comment"># 求得每列的均值，并返回一个ndarray</span></span><br><span class="line">print((df - np.mean(df)) / (np.max(df) - (np.min(df))))</span><br><span class="line"></span><br><span class="line"><span class="comment">### Standard Normalization</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">data = [[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]]</span><br><span class="line">print(StandardScaler().fit_transform(data))  <span class="comment"># 其实这里包含两个步骤，一个训练成一个简单模型，之后转换</span></span><br></pre></td></tr></table></figure></p>
<h1 id="样本不均衡"><a href="#样本不均衡" class="headerlink" title="样本不均衡"></a>样本不均衡</h1><blockquote>
<p>对于样本不均衡，也会给我们进行相关的机器学习任务带来困难</p>
</blockquote>
<p>解决办法：</p>
<ol>
<li>上采样：增加分类中样本较少的类别的采样数量来实现样本的均衡<ol>
<li>直接复制小样本数据，但是容易过拟合</li>
<li>通过一定规则生成新的变量，如smote</li>
</ol>
</li>
<li>下采样：减少分类中多数类样本的样本数量来实现样本均衡<ol>
<li>随机去掉一些多数类，缺点是可能丢失一些重要的信息</li>
<li>根据原始样本生成新样本来代替多数类样本</li>
</ol>
</li>
<li>对每个类别设置权重：通常与数量比成反比</li>
<li>集成学习：生成多组样本来进行训练，例如选择全部的少数样本，每次从多数样本中选择与少数样本数量一致的多数样本进行训练，训练多次</li>
</ol>
<p><strong>生成一个不平衡的样本</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成一个不平衡的样本</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_classification</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line">X, y = make_classification(n_samples=<span class="number">5000</span>,  <span class="comment"># 生成样本的数量</span></span><br><span class="line">                           n_features=<span class="number">2</span>,  <span class="comment"># 生成的样本的特征</span></span><br><span class="line">                           n_informative=<span class="number">2</span>,</span><br><span class="line">                           n_redundant=<span class="number">0</span>,</span><br><span class="line">                           n_repeated=<span class="number">0</span>,</span><br><span class="line">                           n_classes=<span class="number">3</span>,  <span class="comment"># 生成的样本的类别</span></span><br><span class="line">                           n_clusters_per_class=<span class="number">1</span>,</span><br><span class="line">                           weights=[<span class="number">0.01</span>, <span class="number">0.05</span>, <span class="number">0.94</span>],  <span class="comment"># 生成的每个样本类别的权重</span></span><br><span class="line">                           class_sep=<span class="number">0.8</span>,</span><br><span class="line">                           random_state=<span class="number">0</span></span><br><span class="line">                           )</span><br><span class="line">print(X.shape)</span><br></pre></td></tr></table></figure></p>
<h2 id="方法一：上采样"><a href="#方法一：上采样" class="headerlink" title="方法一：上采样"></a>方法一：上采样</h2><blockquote>
<p>通过增加分类样本中样本较少的类别的数量来实现平衡，直接复制小样本数据，缺点：容易过拟合<br>from imblearn.over_sampling import RandomOverSampler<br>ros = RandomOverSampler(random_state=0)<br>X_resampled, y_resampled = ros.fit_sample(X, y)<br>print(sorted(Counter(y_resampled).items()))</p>
</blockquote>
<blockquote>
<p>上采样的另一种方法：通过一定规则生成新变量，如smote<br>from imblearn.over_sampling import SMOTE, ADASYN<br>X_resampled, y_resampled = SMOTE(kind=’borderline1’).fit_sample(X, y)<br>print(sorted(Counter(y_resampled).items()))</p>
</blockquote>
<h2 id="方法二：下采样"><a href="#方法二：下采样" class="headerlink" title="方法二：下采样"></a>方法二：下采样</h2><blockquote>
<p>随机去掉一些多数类，缺点是可能会丢失一些重要信息<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> imblearn.under_sampling <span class="keyword">import</span> RandomUnderSampler</span><br><span class="line">rus = RandomUnderSampler(random_state=<span class="number">0</span>)</span><br><span class="line">X_resampled, y_resampled = rus.fit_sample(X, y)</span><br><span class="line">print(sorted(Counter(y_resampled).items()))</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>根据原始样本，生成新的样本来替换多数类样本, 通过聚类生成新的中心样本点来进行采样<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> imblearn.under_sampling <span class="keyword">import</span> ClusterCentroids</span><br><span class="line">cc = ClusterCentroids(random_state=<span class="number">0</span>)</span><br><span class="line">X_resampled, y_resampled = cc.fit_sample(X, y)</span><br><span class="line">print(sorted(Counter(y_resampled).items()))</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>方法三：集成方法，多次抽取样本的方法<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> imblearn.datasets <span class="keyword">import</span> make_imbalance</span><br><span class="line">ratio = &#123;<span class="number">0</span>:<span class="number">20</span>, <span class="number">1</span>:<span class="number">30</span>, <span class="number">2</span>:<span class="number">40</span>&#125;  <span class="comment"># 抽取的不同样本类别的个数，但是不能超过样本数量，第1类样本20个，第2类样本30个，第3类样本40个</span></span><br><span class="line">X_resampled, y_resampled = make_imbalance(X, y, ratio=ratio)</span><br><span class="line">print(sorted(Counter(y_resampled).items()))</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h1 id="识别异常值"><a href="#识别异常值" class="headerlink" title="识别异常值"></a>识别异常值</h1><ol>
<li>简单的统计分析：对属性值进行一个描述性的统计，从而查看哪些值是不合理的</li>
<li>3σ原则：根据正态分布的定义，距离平均值3σ之外的概率不超过0.003，属于极小概率事件</li>
<li>箱型图分析：箱型图提供了一个标准，即大于或小于箱型图设定的上下界的数值为异常值</li>
<li>聚类分析：如DBSCAN基于密度的聚类方法，可以用于离群点检测</li>
</ol>
<p><strong>Note : 找到异常值之后可以修正异常值，采用上面讲过的填充缺失值的方法</strong></p>
<p><img src="/2019/11/04/数据竞赛-数据预处理以及特征选择/识别异常数据_3σ原则.jpg" alt><br><figure class="image-box" class="index-item-img">
                <img src="/2019/11/04/数据竞赛-数据预处理以及特征选择/识别异常数据_DBSCAN.jpg" alt title class="index-item-img">
                <p></p>
            </figure><br><figure class="image-box">
                <img src="/2019/11/04/数据竞赛-数据预处理以及特征选择/识别异常数据_箱型图分析.jpg" alt title class="index-item-img">
                <p></p>
            </figure></p>
<h2 id="方法一：箱型图分析"><a href="#方法一：箱型图分析" class="headerlink" title="方法一：箱型图分析"></a>方法一：箱型图分析</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">arr = [[np.random.random(), i+np.random.random(), i+<span class="number">1</span>+np.random.random()] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>)]</span><br><span class="line">arr.append([<span class="number">11</span>, <span class="number">44</span>, <span class="number">77</span>])</span><br><span class="line">df = pd.DataFrame(arr)</span><br><span class="line">df.columns = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<h2 id="方法二：3σ原则"><a href="#方法二：3σ原则" class="headerlink" title="方法二：3σ原则"></a>方法二：3σ原则</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">data = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">df.columns = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">print(df.std())  <span class="comment"># 求得标准差</span></span><br><span class="line">th1 = df.mean() + <span class="number">3</span> * df.std()  <span class="comment"># 上界</span></span><br><span class="line">th2 = df.mean() - <span class="number">3</span> * df.std()  <span class="comment"># 下界</span></span><br><span class="line">df[<span class="string">'a'</span>] = df[df[<span class="string">'a'</span>] &gt; th2[<span class="string">'a'</span>]]</span><br><span class="line">df[<span class="string">'a'</span>] = df[df[<span class="string">'a'</span>] &lt; th1[<span class="string">'a'</span>]]</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<h2 id="方法三：识别异常值–DBSCAN"><a href="#方法三：识别异常值–DBSCAN" class="headerlink" title="方法三：识别异常值–DBSCAN"></a>方法三：识别异常值–DBSCAN</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> DBSCAN</span><br><span class="line">arr = [[np.random.random(), i+np.random.random()] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>)]</span><br><span class="line">arr.append([<span class="number">11</span>, <span class="number">44</span>])</span><br><span class="line">arr = np.array(arr)</span><br><span class="line">plt.scatter(arr[:, <span class="number">0</span>], arr[:, <span class="number">1</span>], marker=<span class="string">'o'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">y_pred = DBSCAN(eps = <span class="number">3</span>).fit_predict(arr)</span><br><span class="line">plt.scatter(arr[:, <span class="number">0</span>], arr[:, <span class="number">1</span>], c=y_pred)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h1 id="特征工程"><a href="#特征工程" class="headerlink" title="特征工程"></a>特征工程</h1><ol>
<li>特征处理</li>
<li>特征构建</li>
<li>特征选择</li>
</ol>
<h2 id="特征处理："><a href="#特征处理：" class="headerlink" title="特征处理："></a>特征处理：</h2><h3 id="特征类型"><a href="#特征类型" class="headerlink" title="特征类型:"></a>特征类型:</h3><ol>
<li>数值类型: 连续型，离散型</li>
<li>类别类型: 也就是枚举类型</li>
<li>时间类型: </li>
<li>文本类型: 例如爬下来的一段评论</li>
<li>图形类型: </li>
</ol>
<p><img src="/2019/11/04/数据竞赛-数据预处理以及特征选择/特征处理_LabelEncoder.jpg" alt><br><figure class="image-box" class="index-item-img">
                <img src="/2019/11/04/数据竞赛-数据预处理以及特征选择/特征处理_OneHot.jpg" alt title class="index-item-img">
                <p></p>
            </figure></p>
<h4 id="数值类型的特征："><a href="#数值类型的特征：" class="headerlink" title="数值类型的特征："></a>数值类型的特征：</h4><ol>
<li>特征缩放的几种方法：标准化，归一化，区间缩放</li>
<li>连续变量的离散化， 分箱</li>
</ol>
<h4 id="类别特征："><a href="#类别特征：" class="headerlink" title="类别特征："></a>类别特征：</h4><ol>
<li>one-hot编码</li>
<li>LabelEncoder</li>
</ol>
<h4 id="时间特征："><a href="#时间特征：" class="headerlink" title="时间特征："></a>时间特征：</h4><ol>
<li>持续时间</li>
<li>时间间隔</li>
</ol>
<h3 id="连续变量的离散化：分箱-bin"><a href="#连续变量的离散化：分箱-bin" class="headerlink" title="连续变量的离散化：分箱(bin)"></a>连续变量的离散化：分箱(bin)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame()</span><br><span class="line">df[<span class="string">'Age'</span>] = np.random.randint(<span class="number">1</span>, <span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line">df[<span class="string">'Age'</span>].hist()  <span class="comment"># 显示一个直方图来统计年龄段</span></span><br><span class="line">bin_ranges = [<span class="number">0</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>, <span class="number">100</span>]</span><br><span class="line">bin_names = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="comment"># 将(0, 20]作为一个段，并给定标签1，(20, 30]作为一个段，并给定一个标签2，以此类推</span></span><br><span class="line">df[<span class="string">'Age_bin_custom_range'</span>] = pd.cut(np.array(df[<span class="string">'Age'</span>]), bins=bin_ranges)</span><br><span class="line">df[<span class="string">'Age_bin_custom_label'</span>] = pd.cut(np.array(df[<span class="string">'Age'</span>]), bins=bin_ranges, labels=bin_names)</span><br><span class="line">df[[<span class="string">'Age'</span>, <span class="string">'Age_bin_custom_range'</span>, <span class="string">'Age_bin_custom_label'</span>]].head()</span><br></pre></td></tr></table></figure>
<p><strong>上面是手动分箱，难免会出现一些不规则的划分</strong></p>
<figure class="image-box">
                <img src="/2019/11/04/数据竞赛-数据预处理以及特征选择/特征处理_1.jpg" alt title class="index-item-img">
                <p></p>
            </figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 基于4分位数的自适应二进制方案</span></span><br><span class="line">quantile_list = [<span class="number">0</span>, <span class="number">.25</span>, <span class="number">.5</span>, <span class="number">.75</span>, <span class="number">1.</span>]</span><br><span class="line">quantiles = df[<span class="string">'income'</span>].quantile(quantile_list)</span><br><span class="line"><span class="comment">### 可视化这些分位数</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">df[<span class="string">'income'</span>].hist(bins=<span class="number">30</span>, color=<span class="string">'#A9C5D3'</span>, edgecolor=<span class="string">'black'</span>, grid=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> quantile <span class="keyword">in</span> quantile_list:</span><br><span class="line">    qvl = plt.axvline(quantile, color=<span class="string">'r'</span>)</span><br></pre></td></tr></table></figure>
    
    <a href="/2019/11/04/数据竞赛-数据预处理以及特征选择/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据处理/">数据处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据预处理/">数据预处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/特征工程/">特征工程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/特征选取/">特征选取</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-实战PyTorch手写数字体识别"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/09/29/实战PyTorch手写数字体识别/">实战PyTorch手写数字体识别</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-09-29 19:47:51" datetime="2019-09-29T19:47:51.000Z"  itemprop="datePublished">2019-09-29</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Deep-Learning/">Deep Learning</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Deep-Learning/CNN/">CNN</a></li></ul></li></ul>



        
	<span id="/2019/09/29/实战PyTorch手写数字体识别/" class="leancloud_visitors" data-flag-title="实战PyTorch手写数字体识别" title="实战PyTorch手写数字体识别">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
  <span><i class="icon icon-github"></i></span>

        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <blockquote>
<p>开始学习深度学习，想通过被誉为<strong>深度学习”Hello World”的LeNet5</strong>进行实践，奈何从网络架构看不懂到最后编码没看懂，到现在的恍然大悟，这里面有很多坑不实践只知道网络结构永远是不够的，在学习编码LeNet5的过程中，遇到了很多坑，从网上找资料，五音不全的，总感觉少了很多东西，所以自己索性就总结了自己LeNet5的经验以及一些坑</p>
</blockquote>
<h2 id="网络架构"><a href="#网络架构" class="headerlink" title="网络架构"></a>网络架构</h2><figure class="image-box">
                <img src="/2019/09/29/实战PyTorch手写数字体识别/./CNN.png" alt="LeNet5网络结构图" title class="index-item-img">
                <p>LeNet5网络结构图</p>
            </figure>
<p>输入的图片是 28<em>28</em>1 : <strong>分别表示28像素的高，28像素的宽，1个颜色通道</strong></p>
<p>第一层：卷积层：卷积核大小为6✖️28✖️28, (6表示卷积核的通道数，决定了输出内容的个数，1表示卷积核的通道为1，28)<br>第二层：池化层<br>第三层：卷积层<br>第四层：池化层<br>第五层：全连接层<br>第六层：全连接层<br>第七层：全连接层</p>
<h2 id="数据介绍"><a href="#数据介绍" class="headerlink" title="数据介绍"></a>数据介绍</h2><blockquote>
<p>实战LeNet5架构的数据已经由大神Yann LeCun备好，只需要通过PyTorch下载并加载就可以</p>
</blockquote>
<p>训练集：提供了60000张28<em>28像素的黑白图(说明颜色通道为1)，60000个标签<br>测试集：提供了10000张28</em>28像素的黑白图，10000个标签</p>
<figure class="image-box">
                <img src="/2019/09/29/实战PyTorch手写数字体识别/./数据图展示.png" alt="展示其中的一个数据" title class="index-item-img">
                <p>展示其中的一个数据</p>
            </figure>
<h2 id="一些坑"><a href="#一些坑" class="headerlink" title="一些坑"></a>一些坑</h2><ol>
<li>ReLU() 与 torch.relu() 真的不一样，可别搞混，自己当时就是搞混，以为是一样的，卡了半天</li>
<li></li>
</ol>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><blockquote>
<p>任何一个神经网络的实践数据收集都是起点，这里我们使用了经典的MNIST数据集，包括60000 个训练样本和 10000 个测试样本，样本大小都是1 ✖️ 28 ✖️ 28 (1是指黑白图，也就是只有1个颜色通道)</p>
</blockquote>
<ol>
<li>数据收集</li>
<li>数据处理</li>
<li>网络搭建</li>
<li>针对问题定义损失函数和优化器</li>
<li>训练模型</li>
<li>测试模型准确度</li>
</ol>
<h3 id="数据处理和数据收集"><a href="#数据处理和数据收集" class="headerlink" title="数据处理和数据收集"></a>数据处理和数据收集</h3><blockquote>
<p>PyTorch已经内置了MNIST数据集，因此我们只需要导入相应的包来下载数据集</p>
</blockquote>
<p><strong>注意：数据集都是图像，我们在PyTorch中数据的计算都需要将数据转换为计算图的张量(可以理解为是我们现实中的一个常量)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision.datasets <span class="keyword">as</span> datasets</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> dataloader</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将数据转换为计算图的张量，使用Compose可以将多种变换组合到一起，但是这里我们只将其转换为Tensor</span></span><br><span class="line">transform = transforms.Compose([</span><br><span class="line">    transforms.ToTensor()</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载对应的数据集</span></span><br><span class="line"><span class="comment">## root代表数据集存放的目录</span></span><br><span class="line"><span class="comment">## train代表是否是训练集，用来区分训练集和测试集</span></span><br><span class="line"><span class="comment">## download代表是否需要下载，为true代表如果在root中没有找到数据则进行下载</span></span><br><span class="line"><span class="comment">## transform代表对下载后加载进来的数据做哪些预处理操作</span></span><br><span class="line">train_data = datasets.MNIST(root=<span class="string">'./data'</span>, train=<span class="literal">True</span>, download=<span class="literal">True</span>, transform=transform)</span><br><span class="line">test_data = datasets.MNIST(root=<span class="string">'./data'</span>, train=<span class="literal">False</span>, download=<span class="literal">True</span>, transform=transform)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据加载(使用MINI-Batch加载)：将上面已经加载的数据存档到一个迭代器中方便训练和测试的时候遍历</span></span><br><span class="line"><span class="comment">## 第1个参数代表加载哪个数据集</span></span><br><span class="line"><span class="comment">## batch_size指示每次加载多少张图</span></span><br><span class="line"><span class="comment">## shuffle指示加载数据的时候是否随机加载(打乱)</span></span><br><span class="line">train_data_loader = dataloader.DataLoader(train_data, batch_size=BATCH_SIZE, shuffle=<span class="literal">True</span>)</span><br><span class="line">test_data_loader = dataloader.DataLoader(test_data, batch_size=BATCH_SIZE, shuffle=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h3 id="网络搭建"><a href="#网络搭建" class="headerlink" title="网络搭建"></a>网络搭建</h3><blockquote>
<p>这里我们自定义了网络结构</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyCNN</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        super(MyCNN, self).__init__()</span><br><span class="line">        self.conv = nn.Sequential(</span><br><span class="line">            <span class="comment"># 输入 batch_size, 1, 28, 28</span></span><br><span class="line">            nn.Conv2d(<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, padding=<span class="number">2</span>),</span><br><span class="line">            nn.BatchNorm2d(<span class="number">3</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>),</span><br><span class="line">            nn.MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            <span class="comment"># batch_size, 3, 15, 15</span></span><br><span class="line">            nn.Conv2d(<span class="number">3</span>, <span class="number">16</span>, <span class="number">3</span>, padding=<span class="number">1</span>),</span><br><span class="line">            nn.BatchNorm2d(<span class="number">16</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>),</span><br><span class="line">            nn.MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            <span class="comment"># batch_size, 16, 7, 7</span></span><br><span class="line">            nn.Conv2d(<span class="number">16</span>, <span class="number">32</span>, <span class="number">3</span>, padding=<span class="number">1</span>),</span><br><span class="line">            nn.BatchNorm2d(<span class="number">32</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>),</span><br><span class="line">            nn.MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            <span class="comment"># batch_size, 32, 3, 3</span></span><br><span class="line">        )</span><br><span class="line">        self.lin = nn.Linear(<span class="number">288</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self, input)</span>:</span></span><br><span class="line">        y = self.conv(input)</span><br><span class="line">        y = y.view(input.size(<span class="number">0</span>), <span class="number">-1</span>)</span><br><span class="line">        y = self.lin(y)</span><br><span class="line">        <span class="keyword">return</span> y</span><br></pre></td></tr></table></figure>
<h3 id="定义损失函数和优化器"><a href="#定义损失函数和优化器" class="headerlink" title="定义损失函数和优化器"></a>定义损失函数和优化器</h3><blockquote>
<p>Adam: 一种计算每个参数的自适应学习率的方法<br>分类问题常用的损失函数为交叉熵（Cross Entropy Loss。交叉熵描述了两个概率分布之间的距离，交叉熵越小说明两者之间越接近。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义损失函数以及优化器</span></span><br><span class="line">loss_func = torch.nn.CrossEntropyLoss()  <span class="comment"># 采用交叉熵损失</span></span><br><span class="line">optimizer = torch.optim.Adam(net.parameters(), lr=LEARNING_RATE)  <span class="comment">#采用学习率自己可以调节的Adam优化器</span></span><br></pre></td></tr></table></figure>
<h3 id="训练模型"><a href="#训练模型" class="headerlink" title="训练模型"></a>训练模型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">index_value = <span class="number">0</span></span><br><span class="line"><span class="comment"># 训练集</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> range(NUM_EPOCHS):</span><br><span class="line">    <span class="keyword">for</span> index, (data, label) <span class="keyword">in</span> enumerate(train_data_loader):</span><br><span class="line">        predict_label = net(data)</span><br><span class="line">        loss = loss_func(predict_label, label)</span><br><span class="line">        loss_value = loss.item()</span><br><span class="line">        print(<span class="string">"epoch:&#123;&#125;, index:&#123;&#125;, loss:&#123;&#125;"</span>.format(epoch, index, loss_value))</span><br><span class="line">        opt = &#123;</span><br><span class="line">            <span class="string">'title'</span>: <span class="string">'LeNet5_loss'</span>,</span><br><span class="line">            <span class="string">'xlabel'</span>: <span class="string">'index'</span>,</span><br><span class="line">            <span class="string">'ylabel'</span>: <span class="string">'loss'</span></span><br><span class="line">        &#125;</span><br><span class="line">        vis.line(Y=np.array([loss_value]), X=np.array([index_value]), win=<span class="string">'lenet5_loss'</span>, update=<span class="string">'append'</span>, opts=opt)</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        index_value += <span class="number">1</span></span><br><span class="line">        optimizer.step()</span><br></pre></td></tr></table></figure>
<h3 id="测试模型"><a href="#测试模型" class="headerlink" title="测试模型"></a>测试模型</h3><p>几个注意的地方：</p>
<ol>
<li><strong>进行测试的时候一定要关闭求梯度，以及dropout(使用net.eval())</strong></li>
<li>训练之后的网络，使用net(data)将会得到预测的输出, 例如在该任务中会输出大小为(batch_size, 10)的二维tensor, 每个batch_size对应的10个数字的可能性大小，数字最大的代表预测为该数字</li>
<li>使用net(data).argmax()求得的是二维tensor的最大值，但我们想要的是(batch_size, 10)大小的tensor中每行的最大值对应的下标，因为就是我们预测的值，因此可以采用net(data).argmax(dim=1)</li>
<li>label == net(data).argmax(dim=1) 来判断是否与我们预测的一致，将会返回一个bool组成的tensor</li>
<li>(label == net(data).argmax(dim=1)).sum() 可以计算我们预测的有多少是准确的，只是局限在该batch_size下</li>
</ol>
    
    <a href="/2019/09/29/实战PyTorch手写数字体识别/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Deep-Learning/">Deep Learning</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PyTorch/">PyTorch</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-LeetCode-171-Excel表列序号-md"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/09/10/LeetCode-171-Excel表列序号-md/">[LeetCode]171-Excel表列序号.md</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-09-10 13:08:53" datetime="2019-09-10T13:08:53.000Z"  itemprop="datePublished">2019-09-10</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/LeetCode/">LeetCode</a></li></ul>



        
	<span id="/2019/09/10/LeetCode-171-Excel表列序号-md/" class="leancloud_visitors" data-flag-title="[LeetCode]171-Excel表列序号.md" title="[LeetCode]171-Excel表列序号.md">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
  <span><i class="icon icon-github"></i></span>

        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <h1 id="171-Excel表列序号"><a href="#171-Excel表列序号" class="headerlink" title="171-Excel表列序号"></a>171-Excel表列序号</h1><p><a href="https://leetcode-cn.com/problems/excel-sheet-column-number/" target="_blank" rel="noopener">题目内容</a></p>
<blockquote>
<p>其实这道题就是一个进制转换题，把26个字母看作26进制，只是进制从1开始到26</p>
</blockquote>
<h2 id="第一次提交"><a href="#第一次提交" class="headerlink" title="第一次提交"></a>第一次提交</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">titleToNumber</span><span class="params">(<span class="keyword">char</span> * s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (s[i] != <span class="string">'\0'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        sum = sum * <span class="number">26</span> + s[i] - <span class="number">64</span>;             <span class="comment">//在输入最后一个测试用例的时候("FXSHRXW")首先会产生溢出，之后才会执行减去64的操作</span></span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>结果：999 / 1000 个通过测试用例<br>执行出错信息：Line 5: Char 24: runtime error: signed integer overflow: 2147483624 + 87 cannot be represented in type ‘int’ (solution.c)<br>最后执行的输入：”FXSHRXW”</p>
</blockquote>
<p>总结：在最后一个测试用例执行的时候，发生了int溢出，因为FXSHRXW执行到最后一个字母时，sum<em>26刚执行完还没有发生溢出，直到加上s[i]才发生溢出，所以考虑将**</em>-64移动到前面，避免溢出***</p>
<p>分析：</p>
<ol>
<li>FXSHRX执行完之后，sum取值是82595524</li>
<li>sum * 26 = 2147483624</li>
<li>sum * 26 + s[i] = 2147483624 + 87 因为此时s[i]是最后一个字母W对应的ASCII编码，发生溢出</li>
<li>故猜想把后面的-64提到前面避免溢出，最后跑了一遍可行</li>
</ol>
<h2 id="第二次提交"><a href="#第二次提交" class="headerlink" title="第二次提交"></a>第二次提交</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">titleToNumber2</span><span class="params">(<span class="keyword">char</span> * s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (s[i] != <span class="string">'\0'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// sum = sum * 26 + s[i] - 64;</span></span><br><span class="line">        <span class="comment">// 为了防止溢出，修改加的顺序, 要把-64提到前面</span></span><br><span class="line">        sum = sum * <span class="number">26</span> - <span class="number">64</span> + s[i];</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第二次提交：成功<br>执行用时 :8 ms, 在所有 C 提交中击败了35.51%的用户<br>内存消耗 :6.7 MB, 在所有 C 提交中击败了30.43%的用户</p>
</blockquote>
<figure class="image-box">
                <img src="/2019/09/10/LeetCode-171-Excel表列序号-md/./2.png" alt="第二种解法" title class="index-item-img">
                <p>第二种解法</p>
            </figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><code>C 语言int 范围-2147483648 ~ 2147483647</code></p>
    
    <a href="/2019/09/10/LeetCode-171-Excel表列序号-md/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Job/">Job</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-吴恩达机器学习-03多变量线性回归"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/09/07/吴恩达机器学习-03多变量线性回归/">[吴恩达机器学习]03多变量线性回归</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-09-07 14:28:16" datetime="2019-09-07T14:28:16.000Z"  itemprop="datePublished">2019-09-07</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/机器学习/">机器学习</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/机器学习/第一阶段/">第一阶段</a></li></ul></li></ul>



        
	<span id="/2019/09/07/吴恩达机器学习-03多变量线性回归/" class="leancloud_visitors" data-flag-title="[吴恩达机器学习]03多变量线性回归" title="[吴恩达机器学习]03多变量线性回归">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
  <span><i class="icon icon-github"></i></span>

        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <h1 id="多变量线性回归"><a href="#多变量线性回归" class="headerlink" title="多变量线性回归"></a>多变量线性回归</h1><h2 id="一些表示"><a href="#一些表示" class="headerlink" title="一些表示"></a>一些表示</h2><p>n 表示特征数量<br>m 表示训练集样本数量<br>$$x^i 表示第i个训练样本的输入特征(向量)$$<br>$$x^i_j 表示第i个训练样本的输入特征(向量)中第j维特征的值$$</p>
<h2 id="特征缩放"><a href="#特征缩放" class="headerlink" title="特征缩放"></a>特征缩放</h2><blockquote>
<p>如果每个特征都处于相近的范围内，这样梯度下降法就可以更快的收敛</p>
</blockquote>
<p><strong>特征缩放最主要的就是将每个特征缩放到一个相近的范围，这样梯度下降就可以更快收敛</strong></p>
<p>目标：将每个特征的取值约束到范围-1~1(附近也可以 例如 -2~0.5, 但是-0.00001~0.00002 不可以)之间， 最大不超过-3~3 最小不超过-1/3～1/3, </p>
<h3 id="均值归一化"><a href="#均值归一化" class="headerlink" title="均值归一化"></a>均值归一化</h3><p>公式：归一化后的值 = (归一化前的值 - 归一化前的平均值 / (归一化前的最大值-归一化的最小值)）</p>
<h2 id="梯度下降算法"><a href="#梯度下降算法" class="headerlink" title="梯度下降算法"></a>梯度下降算法</h2><p>当梯度下降算法执行一定轮数之后，曲线将会趋于平缓，此时如何判断到达平缓点，不建议通过阀值来进行判断，建议绘图观看图来进行观察<br><figure class="image-box">
                <img src="/2019/09/07/吴恩达机器学习-03多变量线性回归/./1.png" alt="损失函数随迭代次数变化图" title class="index-item-img">
                <p>损失函数随迭代次数变化图</p>
            </figure></p>
<p>如果得到下面这种图像，说明梯度没有下降反而上升，此时我们可以降低学习率，(因为学习率太大会导致直接越过局部最小点而上升到较高点)</p>
<figure class="image-box">
                <img src="/2019/09/07/吴恩达机器学习-03多变量线性回归/./2.png" alt="代价函数随迭代次数变化图" title class="index-item-img">
                <p>代价函数随迭代次数变化图</p>
            </figure>
<p><strong>注意：数学家已经证明，学习率很小的时候，代价函数会一直下降，所以如果遇到代价函数上涨，要降低学习率。但是也不能太小，太小将会移动很缓慢</strong></p>
<h2 id="特征和多项式回归"><a href="#特征和多项式回归" class="headerlink" title="特征和多项式回归"></a>特征和多项式回归</h2><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><p>在某些情况下，我们不一定要使用给出的变量来作为特征，而是自己可以创造特征</p>
<h3 id="多项式回归"><a href="#多项式回归" class="headerlink" title="多项式回归"></a>多项式回归</h3><blockquote>
<p>在某些情况下，我们使用最简单的线性回归并不能取得很好的拟合效果，此时我们可以深入一步，使用多项式回归尝试。</p>
</blockquote>
<p>例如，在一组数据中，给了临街宽度和房子的深度 以及房价，用来构建模型预测房价</p>
<p>在这个例子中，我们可以构建一个新特征(房子面积=临街宽度*房子深度), 采用新特征来预测房价，画图如下<br><figure class="image-box">
                <img src="/2019/09/07/吴恩达机器学习-03多变量线性回归/./3.png" alt="3.png" title class="index-item-img">
                <p>3.png</p>
            </figure></p>
<p>此时，对于图像我们可以考虑采用二次函数构建，但是随着面积增大，房价趋于平缓，因此不建议使用二次函数构建；也可以采用三次函数，或在线性回归函数后面加上一个平方根项</p>
<p>当我们采用三次函数时，将会转换为$$h_Θ(x) = Θ_0 + Θ_1 x + Θ_2 x^2 + Θ_3 x^3$$</p>
<p>此时我们可以构建三个特征，分别是房子面积，面积的平方，面积的立方</p>
    
    <a href="/2019/09/07/吴恩达机器学习-03多变量线性回归/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ML/">ML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/吴恩达/">吴恩达</a></li></ul>

</div>


            </li>
        
            <li class="post-list-item fade">
                <article id="post-吴恩达机器学习-02单变量线性回归-md"
  class="article-card article-type-post" itemprop="blogPost">
  
    
    
    <div class="top" data-title="2">
    <div class="top-wrap">
        <p></p>
    </div>
</div>
    
    
        


  
    <h3 class="post-title re-title" itemprop="name">
      <a class="post-title-link" href="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/">[吴恩达机器学习]02单变量线性回归.md</a>
    </h3>
  



    
    <div class="post-meta">
        <time class="post-time" title="2019-09-05 19:45:31" datetime="2019-09-05T19:45:31.000Z"  itemprop="datePublished">2019-09-05</time>

        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/机器学习/">机器学习</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/机器学习/第一阶段/">第一阶段</a></li></ul></li></ul>



        
	<span id="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/" class="leancloud_visitors" data-flag-title="[吴恩达机器学习]02单变量线性回归.md" title="[吴恩达机器学习]02单变量线性回归.md">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

        


        
  <span><i class="icon icon-github"></i></span>

        
    </div>
    
    <div class="post-content" id="post-content" itemprop="postContent">
    
    
        <h1 id="单变量线性回归"><a href="#单变量线性回归" class="headerlink" title="单变量线性回归"></a>单变量线性回归</h1><h2 id="模型描述"><a href="#模型描述" class="headerlink" title="模型描述"></a>模型描述</h2><h3 id="课程用到的一些符号说明"><a href="#课程用到的一些符号说明" class="headerlink" title="课程用到的一些符号说明"></a>课程用到的一些符号说明</h3><ul>
<li>m = 训练集的样本数量</li>
<li>x = 输入变量 （或特征）</li>
<li>y = 输出变量 (预测的值)</li>
<li>(x , y) 表示一个训练样本</li>
<li>$$(x_i, y_i)表示第i个训练样本$$ </li>
</ul>
<p><img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/2单变量线性回归.png" alt="单变量线性回归.png"></p  class="index-item-img">
<blockquote>
<p>一般可以表示为$$h(x) = c_1 * x + c_2$$</p>
</blockquote>
<h2 id="代价函数"><a href="#代价函数" class="headerlink" title="代价函数"></a>代价函数</h2><p>在线性回归预测中，我们希望获得两个理想的参数$$c_1和c_2$$使得我们预测的结果h与实际的结果y的差值越小越好。这里我们引入了代价函数$$\sum_{i=1}^m{(h-y)^2} ，$$ 也就是<strong>预测值与实际值的误差平方和越小越好</strong>, 也就是<strong>最小化代价函数</strong></p>
<blockquote>
<p>代价函数也被成为平方误差函数或平方误差代价函数</p>
</blockquote>
<p>此时我们已经将问题转换为求使得代价函数$$\sum_{i=1}^m{(h-y)^2} $$最小的两个理想参数$$c_1和c_2$$， 我们可以把其看作线性回归的整体目标函数。</p>
<p>为了更直观理解，吴恩达老师将其代价函数简化为如下图中描述(即在求和的基础上除以2m)</p>
<figure class="image-box">
                <img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/02代价函数.png" alt="02代价函数.png" title class="index-item-img">
                <p>02代价函数.png</p>
            </figure>
<figure class="image-box">
                <img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/02代价函数2.png" alt="02代价函数2.png" title class="index-item-img">
                <p>02代价函数2.png</p>
            </figure>
<p>也有其他评估线性回归的代价函数，但是平方误差和是我们最常见的一个评估手段。</p>
<h2 id="梯度下降法-Gradient-Descent-Algorithm"><a href="#梯度下降法-Gradient-Descent-Algorithm" class="headerlink" title="梯度下降法(Gradient Descent Algorithm)"></a>梯度下降法(Gradient Descent Algorithm)</h2><blockquote>
<p>梯度下降法可以将代价函数最小化，不仅可以用来最小化代价函数，而且可以最小化其他函数，并且应用领域十分广泛</p>
</blockquote>
<p>梯度下降的思路：</p>
<ol>
<li>给要确定值的所有参数一个初始值(通常我们都把他们初始化为0)</li>
<li>不停的改变所有参数来减小代价函数的值直到找到了代价函数的最小值</li>
</ol>
<blockquote>
<p>计算注意事项：所有参数必须做到同时更新，不可以更新后赋值。梯度下降必须做到所有参数的同时更新。</p>
</blockquote>
<figure class="image-box">
                <img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/梯度下降公式以及注意事项.png" alt="梯度下降公式以及注意事项" title class="index-item-img">
                <p>梯度下降公式以及注意事项</p>
            </figure>
<p>其中α称为学习率，也就是决定梯度下降走路的步伐，控制我们以多大的速度更新参数$$Θ_j,第二部分是导数项，</p>
<p>吴恩达老师提出的问题：对于J(Θ_1),如果Θ_1已经处于一个局部最优点，那么下一步梯度下降会怎样？$$</p>
<blockquote>
<p>$$因为已经处于局部最优点，此时导数为0，所以Θ_1将不会再改变，也就是Θ_1就是原来的Θ_1，将会使我们的解一直保持在局部最优解中$$</p>
</blockquote>
<figure class="image-box">
                <img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/梯度下降2.png" alt="梯度下降一些问题" title class="index-item-img">
                <p>梯度下降一些问题</p>
            </figure>
<p>注意：随着梯度下降算法的运行，后面的步骤中，导数将会变得越来越小，使得梯度下降越来越慢，因此没必要在后面的步骤中减小学习率</p>
<h2 id="梯度下降与代价函数结合–线性回归"><a href="#梯度下降与代价函数结合–线性回归" class="headerlink" title="梯度下降与代价函数结合–线性回归"></a>梯度下降与代价函数结合–线性回归</h2><figure class="image-box">
                <img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/线性回归总结.png" alt="线性回归总结" title class="index-item-img">
                <p>线性回归总结</p>
            </figure>
<p>Batch梯度下降法，表示每一步梯度下降，我们都遍历了整个训练集，其实在数学中可以通过方程组求出最小代价函数的参数，但是对于大规模数据集，梯度下降比较实用</p>
<p><img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/梯度下降推导公式1.png" alt="梯度下降公式1"><br><figure class="image-box" class="index-item-img">
                <img src="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/梯度下降推导公式2.png" alt="梯度下降公式2" title class="index-item-img">
                <p>梯度下降公式2</p>
            </figure></p>
    
    <a href="/2019/09/05/吴恩达机器学习-02单变量线性回归-md/" class="post-more waves-effect waves-button">
        more
    </a>
    </div>
</article>

<div class="post-footer">
    
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ML/">ML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/吴恩达/">吴恩达</a></li></ul>

</div>


            </li>
        
        </ul>
        
<nav id="page-nav">
    <div class="inner">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
    </div>
</nav>

    </div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://github.com/sivanWu0222" target="_blank">GitHub</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://weibo.com/Msingwen0222/home?wvr=5" target="_blank">新浪微博</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.linkedin.com/in/%E6%99%93%E6%96%87-%E5%90%B4-79057a121/" target="_blank">Linkedin</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1666762170&amp;site=qq&amp;menu=yes" target="_blank">QQ</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://zh-cn.facebook.com/people/SiVan-Wu/100014408918389" target="_blank">Facebook</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=xfTz8-Py8-f08vWFtLTrpqqo" target="_blank">Contact</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://twitter.com/SiVan_Wu" target="_blank">Twitter</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                逸如风(yirufeng) &copy; 2016 - 2019
            </span>

           	
           	<span>
           		<a href="http://beian.miit.gov.cn/" target="_blank">已实名认证</a>
           	</span>
           	

            

            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.sivan.tech/&title=yirufeng's Blog&pic=http://www.sivan.tech/img/1.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.sivan.tech/&title=yirufeng's Blog&source=吴晓文的个人博客，逸如风，" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.sivan.tech/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=yirufeng's Blog&url=http://www.sivan.tech/&via=http://www.sivan.tech" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.sivan.tech/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAAAAAAZai4+AAABW0lEQVR42u3awQ4CIQxF0fn/nx63YxS8jzox0svKYAJnFkApPQ7czku79rz+O+o/7miyZG3EOqdthCATz6GjuWTJ6swaDZpOwLeVDwZZsmQtHca8X5YsWRVWffHLkiVrziJBM8H9IJaXJWsLFs/q1H/fkt+SJevPWWehzQ9avim8GVmWrGasdJGTQHl+nJPklCxZstJAOZ1s8XFFlqytWfzamRYQpNfaILMlS9amLDIET+yuJZKexpclqxnrWwmjIBReSzPJkrU1ay4l4S8vA+KfIUtWNxZPBq09i5IkL9qrZMnampU+k9SnRJuOLFnNWOnxmU6/Vl0gS1Y3VqXIgH93XGwnS1YzVr0uLo1444helqw2LH4d5RddvkHIkiUrHZoH0PWiBFmyZK0t8jT4Xnz5kSWrPYuX7/AtI3jmlCWrASsNmtNUEU8Ty5LVk8UTSTx1Wzn4ZclqxnoA5VpLEt7peNcAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.2"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.2"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.2"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.2"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.2"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    



<script type="text/javascript" src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
<script type="text/javascript" src="/js/plugins/leancloud_visitors.js?v=1.4.2"></script>



    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '死鬼去哪里了！';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)咦!又好了!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
</body>
</html>
